/***  mtsk01.txt  ***/

1．課題
	「2つのタスク切り替えのプログラム」を２つ紹介してあるが，
	読み取って，自分の言葉でタスク切り替えの要点を説明しなさい。
	
2．考察
	タスクの切り替えを行うて基本的な手順は次の通りである。
		1．スタックポインタは「現在のタスクのスタック領域の次」に
		　行わないといけない命令のアドレスが保存されている場所を
		　示した状態になっている。
		　　これを保存し、全ての汎用レジスタを、現在のタスクのコンテキスト
		　に保存する。
		2．次のタスクの保存領域の内容を全ての汎用レジスタに復帰する。
		　このとき、スタックポインタは、「次のタスクのスタック領域の次」
		　に行わないといけない命令のアドレス（戻り値＋CCR）が保存されている。
		3．割り込み処理からret(return from exception)命令をすることで、
		次のタスクの処理に入る。
		
		　タスク切り替えについて、汎用レジスタの保存領域はどこにおいてもよいが、
		講義資料で紹介されている2つのプログラムのうち、
		　1つ目が、タスクに与えたスタック領域と別にレジスタ退避領域を設けている。
		　これに対して、2つ目は
		タスクに与えたスタック領域の中にレジスタ退避領域などを設けている。
		　コンテキスト保存領域については、次のように使用するとプログラムの記述が楽になる。
		　
		　・レジスタ退避場所を別に設けない。
		　・タスクが使用中のスタックの上に退避させる。
		　・スタックポインタのみ特別に退避させる。
		　
		　この方法はレジスタ保存領域が固定されないので、とらえにくいが、
		　プログラムの記述が楽になり、スマートになる。
		　
		　この方法でタスクを切り替えるときの具体的な手順
		　
		　	1．汎用レジスタを現在のタスク領域のスタックの一番上に乗せる。
		　	2．直前のタスク番号を考慮して、スタックポインタを現在のコンテキストの保存場所に保存数r。
		　	3．タスクスイッチャが仕事を行う。
		　	4．次のコンテキストの保存場所からスタックポインタに復帰
		　	5．復帰したスタックポインタから、汎用レジスタを復帰
		　	6．この状態だと、タスク1の戻り番地とCCRがタスク1のスタックの1番上にある。
		　	7．ret命令で次のタスクの実行へ。
3．まとめ
	タスクの切り替えをタイマ割り込みで行うプログラムの作成方法を理解した。